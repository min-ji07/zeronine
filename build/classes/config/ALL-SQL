-- 회원 정보 TABLE
CREATE TABLE USER_MEMBER (
      USERNO NUMBER(10), 
      USERID VARCHAR2(50) PRIMARY KEY, 
      USERNAME VARCHAR2(100) NOT NULL, 
      PASSWORD VARCHAR2(100) NOT NULL,
      EMAIL VARCHAR2(100) NOT NULL,  
      ADDRESS1 VARCHAR2(300), 
      ADDRESS2 VARCHAR2(300),
      ADDRESS3 VARCHAR2(300),
      ENROLLDATE DATE DEFAULT SYSDATE
);

-- 회원 USERNO 증가용 SEQUENCE
CREATE SEQUENCE SEQ_USERNO 
START WITH 1 
INCREMENT BY 1;

-- 상품등록용 TABLE
CREATE TABLE USER_PRODUCT(
    PNO NUMBER(10) PRIMARY KEY, /* 상품 번호 */
    MAINIMAGE VARCHAR(50) NOT NULL, /* 메인 이미지 / 파일 */
    MAINTITLE VARCHAR(50) NOT NULL, /* 상품명 */
    MAINPRICE NUMBER(20) NOT NULL, /* 판매가 */
    OP1_TITLE VARCHAR(50), /* 옵션상품명1 */
    OP1_PRICE VARCHAR(10), /* 옵션가1 */
    OP2_TITLE VARCHAR(50), /* 옵션상품명2 */
    OP2_PRICE VARCHAR(10), /* 옵션가2 */
    OP3_TITLE VARCHAR(50), /* 옵션상품명3 */
    OP3_PRICE VARCHAR(10), /* 옵션가3 */
    RADIO VARCHAR(10) NOT NULL, /* code1 = 의류 / code2 =  */
    DV_PRICE NUMBER(10) NOT NULL, /* 배송비 */
    DV_DUE NUMBER(10) NOT NULL, /* 배송기간 */
    MIN_PERSON NUMBER(10) NOT NULL, /* 최소구매인원 */
    MIN_COUNT NUMBER(10) NOT NULL, /* 최소구매수량 */
    HASHTAG1 VARCHAR(20), /* 해시태그1 */
    HASHTAG2 VARCHAR(20), /* 해시태그2 */
    HASHTAG3 VARCHAR(20), /* 해시태그3 */
    DETAILIMAGE VARCHAR(50) NOT NULL, /* 상세이미지 */
    WRITERID VARCHAR2(50) NOT NULL,
    LIKECOUNT NUMBER,
    CONSTRAINT FK_USER_PRODUCT FOREIGN KEY(WRITERID)
    REFERENCES USER_MEMBER(USERID)
);
-- 상품번호 증가용 SEQUENCE
CREATE SEQUENCE ITEM_SEQ START WITH 1 INCREMENT BY 1;


--LIKEY테이블 생성
CREATE TABLE LIKEY(
   LIKEYNO      NUMBER          PRIMARY KEY,
   BNO       NUMBER,
   USERID       VARCHAR2(20),
   LIKEY_YN    VARCHAR2(20),
   LIKECOUNT    NUMBER
);

--LIKEY용 시퀀스 생성
CREATE SEQUENCE LIKEY_SEQ 
START WITH 1 
INCREMENT BY 1;




--댓글용 DB 생성
CREATE TABLE DQA(
   DNO       NUMBER          PRIMARY KEY,
   BNO       NUMBER         NOT NULL,
   DCONTENT    VARCHAR2(2000)   NOT NULL,
   USERID      VARCHAR2(15)   NOT NULL,
   DDATE      DATE,
   REF_DNO      NUMBER,
   CLEVEL      NUMBER,
   CWRITER      VARCHAR2(20),
   LOC         NUMBER
);

--댓글용 시퀀스 생성
CREATE SEQUENCE SEQ_CNO 
START WITH 1 
INCREMENT BY 1;




-- 고객센터 게시글 등록 TABLE
CREATE TABLE USER_QUESTION(
    UNO NUMBER PRIMARY KEY,
    USERID VARCHAR2(50) NOT NULL,
    TITLE VARCHAR2(500) NOT NULL,
    CONTENT VARCHAR2(3000) NOT NULL,
    ADDDATE DATE DEFAULT SYSDATE,
    COUNT NUMBER DEFAULT 0,
    STATUS VARCHAR2(1) DEFAULT 'Y' CHECK (STATUS IN ('Y', 'N'))
);

-- 고객센터 게시글번호 증가용 SEQUENCE
CREATE SEQUENCE SEQ_UNO
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;

-- 고객센터 글 댓글 저장용 TABLE
CREATE TABLE QUESTION_COMMENT(
    CNO NUMBER PRIMARY KEY,
    UNO NUMBER NOT NULL,
    CCONTENT VARCHAR2(2000) NOT NULL,
    CWRITER VARCHAR2(50) NOT NULL,
    CDATE DATE DEFAULT SYSDATE,
    REF_CNO NUMBER,
    CLEVEL NUMBER,
    CONSTRAINT FK_CWRITER FOREIGN KEY(CWRITER) REFERENCES USER_MEMBER(USERID) ON DELETE SET 

NULL,
    CONSTRAINT FK_REF_CNO FOREIGN KEY(REF_CNO) REFERENCES QUESTION_COMMENT(CNO) ON DELETE 

CASCADE
);

-- 고객센터 글 댓글번호 증가용 SEQUENCE
CREATE SEQUENCE SEQ_QNO   --- 기존 CNO였으나 중복되어서 QNO로 변경
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;

CREATE TABLE ORDER_STATUS(
    ORDER_NUM NUMBER PRIMARY KEY,   --주문번호
    ORDER_DATE DATE DEFAULT SYSDATE,-- 주문날짜
    ORDER_PNAME VARCHAR2(100),      -- 주문상품명
    USERNAME VARCHAR2(50),          -- 주문자명
    USERID VARCHAR2(50),            -- 주문자아이디
    SELLERID VARCHAR2(50),          -- 판매자아이디
    USER_PHONE VARCHAR2(50),        -- 구매자연락처
    DUE_ADDR VARCHAR2(100),         -- 배송지
    RESULT_PRICE VARCHAR2(20),            -- 결제가격
    RESULT_STATUS VARCHAR2(20)      -- 결제방법
);
CREATE SEQUENCE ORDER_SEQ;

COMMIT;

DROP TABLE USER_MEMBER CASCADE CONSTRAINTS;
DROP SEQUENCE SEQ_USERNO;
DROP TABLE USER_PRODUCT CASCADE CONSTRAINTS;
DROP SEQUENCE ITEM_SEQ;
DROP TABLE LIKEY;
DROP SEQUENCE LIKEY_SEQ;
DROP TABLE DQA;
DROP SEQUENCE SEQ_CNO;
DROP TABLE USER_QUESTION;
DROP SEQUENCE SEQ_UNO;
DROP TABLE QUESTION_COMMENT;
DROP SEQUENCE SEQ_QNO;
DROP TABLE ORDER_STATUS;
DROP SEQUENCE ORDER_SEQ;

SELECT * FROM USER_MEMBER;